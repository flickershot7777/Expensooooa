<div class="view-expense-container">
  <div class="page-header">
    <button class="back-btn" [routerLink]="['/dashboard']">← Back to Dashboard</button>
    <div class="header-content">
      <div class="header-text">
        <h1>Expense History</h1>
        <p>Manage and track all your expenses</p>
      </div>
      <button class="btn btn-primary" [routerLink]="['/add-expense']">
        + Add New Expense
      </button>
    </div>
  </div>

  <div class="content-container">
    <div class="filters-section">
      <div class="filter-group">
        <label>Filter by Category:</label>
        <select [(ngModel)]="selectedCategory" (change)="onCategoryFilter()" class="filter-control">
          <option value="">All Categories</option>
          <option *ngFor="let category of categories" [value]="category">{{ category }}</option>
        </select>
      </div>

      <div class="filter-group">
        <label>Sort by:</label>
        <select [(ngModel)]="sortBy" (change)="onSort()" class="filter-control">
          <option value="date">Date</option>
          <option value="amount">Amount</option>
          <option value="title">Title</option>
          <option value="category">Category</option>
        </select>
      </div>

      <div class="filter-group">
        <label>Order:</label>
        <select [(ngModel)]="sortOrder" (change)="onSort()" class="filter-control">
          <option value="desc">Descending</option>
          <option value="asc">Ascending</option>
        </select>
      </div>

      <div class="total-display">
        <span class="total-label">Total:</span>
        <span class="total-amount">${{ totalAmount | number:'1.2-2' }}</span>
      </div>
    </div>

    <div *ngIf="isLoading" class="loading-state">
      <div class="loading-spinner"></div>
      <p>Loading expenses...</p>
    </div>

    <div *ngIf="!isLoading && filteredExpenses.length === 0" class="empty-state">
      <div class="empty-icon">📋</div>
      <h3>No expenses found</h3>
      <p *ngIf="selectedCategory">No expenses found in the selected category.</p>
      <p *ngIf="!selectedCategory">You haven't added any expenses yet.</p>
      <button class="btn btn-primary" [routerLink]="['/add-expense']">Add Your First Expense</button>
    </div>

    <div *ngIf="!isLoading && filteredExpenses.length > 0" class="expenses-grid">
      <div class="expense-card" *ngFor="let expense of filteredExpenses">
        <div class="expense-header">
          <h3 class="expense-title">{{ expense.title }}</h3>
          <div class="expense-actions">
            <button class="action-btn delete-btn" (click)="deleteExpense(expense)" title="Delete">
              🗑️
            </button>
          </div>
        </div>

        <div class="expense-details">
          <div class="detail-row">
            <span class="detail-label">Amount:</span>
            <span class="expense-amount">${{ expense.amount | number:'1.2-2' }}</span>
          </div>

          <div class="detail-row">
            <span class="detail-label">Category:</span>
            <span class="expense-category">{{ expense.category }}</span>
          </div>

          <div class="detail-row">
            <span class="detail-label">Date:</span>
            <span class="expense-date">{{ formatDate(expense.date) }}</span>
          </div>

          <div *ngIf="expense.description" class="detail-row description">
            <span class="detail-label">Description:</span>
            <p class="expense-description">{{ expense.description }}</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
